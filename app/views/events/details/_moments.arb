# local variable event

#make a list of occurrences
occurrences = event.event_details.all.collect { |ed| [ed.studio, ed.occurrences] }

ul :class => "times-places moments" do
  occurrences.each do |studio, occurrence|
    li :class => "time-place moment" do
      div :class => "time-moment" do
        time do 
          span l event.event_details.first.starttime, :format => :day
          span l event.event_details.first.starttime, :format => :hours_minutes
        end
      end
      span :class => "place" do
        a (studio.location.name + " " + studio.name), :href => url_for(:controller => 'pages', :action => 'show', :id => 'studios')
      end
    end
  end  
end