# local variable workshops: collection of workshop type events 
# local variable combinations: enable "workshop-kombinationen"

if workshops.length > 0

  # get details ordered grouped by beginning/end, and ordered by title
  events_by_dates = workshops
    .sort_by { |e| e.firsttime }
    .sort
    .group_by { |e| [e.start_date, e.end_date] }
    .sort

  ul :class => "workshops" do
    
    events_by_dates.each do |dates, events|
      # FOLLOWING CODE COMING IN VERSION 2
      # li :class => "controls" do
      #   h3 :class => "header" do 
      #     span t :workshops_name
      #     if combinations
      #       text_node "/"
      #       span t(:workshops_combinations)
      #     end
      #   end
      # end        
      li :class => "group" do
        div :class => "time-duration" do
          time l(dates[0], :format => :short) + "-" + l(dates[1], :format => :short)
        end        
        ul :class => "classes" do
          events.each do |workshop| 
            li :class => "class" do
              a :href => event_path(workshop) do

                h4 workshop.title, :href => event_path(workshop), :class => "title"
                span workshop.people.map { |p| p.name }.join(', '), :class => "teacher" if workshop.people.length > 0
                div :class => "class-data" do
                  render :partial => "/events/details/workshop_days", :locals => {:event => workshop}
                end
              end
            end
          end
        end
      end
    end
  end
end
